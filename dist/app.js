(()=>{var e={738:(e,t,r)=>{const s=r(147),n=r(17),o=r(37);function i(e){console.log(`[dotenv][DEBUG] ${e}`)}const a=/^\s*([\w.-]+)\s*=\s*(.*)?\s*$/,d=/\\n/g,l=/\r\n|\n|\r/;function u(e,t){const r=Boolean(t&&t.debug),s={};return e.toString().split(l).forEach((function(e,t){const n=e.match(a);if(null!=n){const e=n[1];let t=n[2]||"";const r=t.length-1,o='"'===t[0]&&'"'===t[r];"'"===t[0]&&"'"===t[r]||o?(t=t.substring(1,r),o&&(t=t.replace(d,"\n"))):t=t.trim(),s[e]=t}else r&&i(`did not match key and value when parsing line ${t+1}: ${e}`)})),s}e.exports.config=function(e){let t=n.resolve(process.cwd(),".env"),r="utf8",a=!1;var d;e&&(null!=e.path&&(t="~"===(d=e.path)[0]?n.join(o.homedir(),d.slice(1)):d),null!=e.encoding&&(r=e.encoding),null!=e.debug&&(a=!0));try{const e=u(s.readFileSync(t,{encoding:r}),{debug:a});return Object.keys(e).forEach((function(t){Object.prototype.hasOwnProperty.call(process.env,t)?a&&i(`"${t}" is already defined in \`process.env\` and will not be overwritten`):process.env[t]=e[t]})),{parsed:e}}catch(e){return{error:e}}},e.exports.parse=u},21:(e,t,r)=>{"use strict";r.r(t),r.d(t,{NIL:()=>S,parse:()=>b,stringify:()=>c,v1:()=>m,v3:()=>v,v4:()=>w,v5:()=>C,validate:()=>l,version:()=>O});const s=require("crypto");var n=r.n(s);const o=new Uint8Array(256);let i=o.length;function a(){return i>o.length-16&&(n().randomFillSync(o),i=0),o.slice(i,i+=16)}const d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,l=function(e){return"string"==typeof e&&d.test(e)},u=[];for(let e=0;e<256;++e)u.push((e+256).toString(16).substr(1));const c=function(e,t=0){const r=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!l(r))throw TypeError("Stringified UUID is invalid");return r};let f,p,g=0,h=0;const m=function(e,t,r){let s=t&&r||0;const n=t||new Array(16);let o=(e=e||{}).node||f,i=void 0!==e.clockseq?e.clockseq:p;if(null==o||null==i){const t=e.random||(e.rng||a)();null==o&&(o=f=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==i&&(i=p=16383&(t[6]<<8|t[7]))}let d=void 0!==e.msecs?e.msecs:Date.now(),l=void 0!==e.nsecs?e.nsecs:h+1;const u=d-g+(l-h)/1e4;if(u<0&&void 0===e.clockseq&&(i=i+1&16383),(u<0||d>g)&&void 0===e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");g=d,h=l,p=i,d+=122192928e5;const m=(1e4*(268435455&d)+l)%4294967296;n[s++]=m>>>24&255,n[s++]=m>>>16&255,n[s++]=m>>>8&255,n[s++]=255&m;const b=d/4294967296*1e4&268435455;n[s++]=b>>>8&255,n[s++]=255&b,n[s++]=b>>>24&15|16,n[s++]=b>>>16&255,n[s++]=i>>>8|128,n[s++]=255&i;for(let e=0;e<6;++e)n[s+e]=o[e];return t||c(n)},b=function(e){if(!l(e))throw TypeError("Invalid UUID");let t;const r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r};function y(e,t,r){function s(e,s,n,o){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof s&&(s=b(s)),16!==s.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let i=new Uint8Array(16+e.length);if(i.set(s),i.set(e,s.length),i=r(i),i[6]=15&i[6]|t,i[8]=63&i[8]|128,n){o=o||0;for(let e=0;e<16;++e)n[o+e]=i[e];return n}return c(i)}try{s.name=e}catch(e){}return s.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",s.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",s}const v=y("v3",48,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),n().createHash("md5").update(e).digest()})),w=function(e,t,r){const s=(e=e||{}).random||(e.rng||a)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=s[e];return t}return c(s)},C=y("v5",80,(function(e){return Array.isArray(e)?e=Buffer.from(e):"string"==typeof e&&(e=Buffer.from(e,"utf8")),n().createHash("sha1").update(e).digest()})),S="00000000-0000-0000-0000-000000000000",O=function(e){if(!l(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)}},138:(e,t,r)=>{r(738).config();const s=r(685),n=r(147),o=r(310),{v4:i}=r(21),{parse:a}=r(477),{validateUrl:d}=r(475),{validatePerson:l}=r(53),u=process.env.PORT||3e3,c=s.createServer(((e,t)=>{let r="",s=n.createReadStream("./db.json");s.on("data",(e=>r+=e));let u=o.parse(e.url,!0);s.on("end",(()=>{let s=JSON.parse(r).persons,o=d(u.pathname);if(o.isValid){if("GET"==e.method){if(u.pathname.match(/^\/person$/))t.statusCode=200,t.setHeader("Content-Type","application/json"),t.end(r);else if(u.pathname.match(/^\/person\/\d|-|\w/g)){let e=u.pathname.split("/")[2],r=s.find((t=>t.id===e));r?(t.statusCode=200,t.setHeader("Content-Type","application/json"),r=JSON.stringify(r),t.end(r)):(t.statusCode=404,t.end(`user with id ${e} isn't finded`))}}else if("POST"==e.method){let r="";e.on("data",(e=>r+=e.toString())),e.on("end",(e=>{let o=a(r),d={id:i(),name:o.name?`${o.name}`:null,age:o.age?+o.age:null,hobbies:o.hobbies?o.hobbies.split(","):[]},u=l(d);u.isValid?(t.statusCode=201,t.setHeader("Content-Type","application/json"),s.push(d),s={persons:[...s]},s=JSON.stringify(s),n.createWriteStream("./db.json",{flags:"w"}).write(s),d=JSON.stringify(d),t.end(d)):(t.statusCode=u.statusCode,t.end(u.message))}))}else if("PUT"==e.method)if(u.pathname.match(/^\/person\/\d|-|\w/g)){let r=u.pathname.split("/")[2];if(s.find((e=>e.id===r))){let o="";e.on("data",(e=>o+=e.toString())),e.on("end",(e=>{let i=a(o);t.statusCode=200,t.setHeader("Content-Type","application/json");let d={id:r,name:i.name,age:i.age,hobbies:i.hobbies.split(",")};s.forEach(((e,t)=>{e.id===r&&(s[t]=d)})),s={persons:[...s]},s=JSON.stringify(s),n.createWriteStream("./db.json",{flags:"w"}).write(s),d=JSON.stringify(d),t.end(d)}))}else t.statusCode=404,t.end(`user with id ${r} isn't finded`)}else t.statusCode=400,t.end("user's id invalid");else if("DELETE"==e.method&&u.pathname.match(/^\/person\/\d|-|\w/g)){let e=u.pathname.split("/")[2];s.find((t=>t.id===e))?(s=s.filter((t=>t.id!==e)),s={persons:[...s]},s=JSON.stringify(s),n.createWriteStream("./db.json",{flags:"w"}).write(s),t.statusCode=204,t.setHeader("Content-Type","text/html"),t.end("<p>peerson was dremove</p>")):(t.statusCode=404,t.end(`user with id ${e} isn't finded`))}}else t.statusCode=o.statusCode,t.end(`${o.message}`)})),s.on("error",(e=>{t.statusCode=500,t.end("Error",e.message)}))}));c.listen(u,(()=>{console.log(`Server running at port ${u}`)})),e.exports={server:c}},53:e=>{e.exports={validatePerson:function(e){return e.name&&"string"==typeof e.name?e.age?e.hobbies||"array"==typeof e.hobbies?(e.hobbies.forEach((t=>{if("string"!=typeof t)return{isValid:!1,message:e.hobbies?"hobbies shoudbe should be array of string":"hobbies is required",statusCode:400}})),{isValid:!0}):{isValid:!1,message:e.hobbies?"hobbies shoudbe should be array of string":"hobbies is required",statusCode:400}:{isValid:!1,message:e.name?"age shoudbe number":"age is required",statusCode:400}:{isValid:!1,message:e.name?"name shoudbe string":"name is required",statusCode:400}}}},475:(e,t,r)=>{const{validate:s}=r(21);e.exports={validateUrl:function(e){let t=e.split("/");return"person"===t[1]&&t.length<=3?t[2]&&!s(t[2])?{isValid:!1,message:"id is not uuid",statusCode:404}:{isValid:!0,message:"url is valid"}:{isValid:!1,message:"url is incorrect",statusCode:404}}}},147:e=>{"use strict";e.exports=require("fs")},685:e=>{"use strict";e.exports=require("http")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")},477:e=>{"use strict";e.exports=require("querystring")},310:e=>{"use strict";e.exports=require("url")}},t={};function r(s){var n=t[s];if(void 0!==n)return n.exports;var o=t[s]={exports:{}};return e[s](o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r(138)})();